<!DOCTYPE html>
<html class="no-js theme-{{ preferences.get_value('simple_style') or get_setting('ui.theme_args.simple_style') or 'auto' }} center-alignment-{{ preferences.get_value('center_alignment') and 'yes' or 'no' }}" lang="{{ locale_rfc5646 }}" {% if rtl %} dir="rtl"{% endif %}>
<head>
  <meta charset="UTF-8">
  <meta name="endpoint" content="{{ endpoint }}">
  <meta name="description" content="MusaiSearch — a privacy-respecting, purple-steel metasearch experience">
  <meta name="keywords" content="MusaiSearch, search, search engine, metasearch, music, code, purple steel">
  <meta name="generator" content="searxng/{{ searx_version }}">
  <meta name="referrer" content="no-referrer">
  <meta name="robots" content="noarchive">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="format-detection" content="telephone=no">
  <meta name="theme-color" content="#1e2030">
  <style>
    /* Paint-safe fallback to avoid white flash before CSS loads */
    html,
    body {
      background: #1e2030;
      color: #ececf4;
    }
    html.theme-light,
    html.theme-light body {
      background: #eafaf7;
      color: #222222;
    }
    html.theme-black,
    html.theme-black body {
      background: #000000;
      color: #e5e7eb;
    }
  </style>
  <script>
    (function setThemeColorImmediate()
    {
      try
      {
        var cls = document.documentElement.className || '';
        var isAuto = /(^|\s)theme-auto(\s|$)/.test(cls);
        var getESTHour = function()
        {
          try
          {
            return parseInt(new Intl.DateTimeFormat('en-US', { hour: 'numeric', hour12: false, timeZone: 'America/New_York' }).format(new Date()), 10);
          }
          catch (e)
          {
            return (new Date()).getUTCHours();
          }
        };
        var prefersLight = isAuto
          ? (function(){ var h = getESTHour(); return h >= 7 && h < 19; })()
          : (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches);
        var light = '#eafaf7';
        var dark = '#1e2030';
        var black = '#000000';
        var color = dark;
        if ((/(^|\s)theme-light(\s|$)/.test(cls)) || (isAuto && prefersLight))
        {
          color = light;
        }
        if (/(^|\s)theme-black(\s|$)/.test(cls))
        {
          color = black;
        }
        var meta = document.querySelector('meta[name="theme-color"]');
        if (meta) { meta.setAttribute('content', color); }
        document.documentElement.style.backgroundColor = color;
        if (document.body) { document.body.style.backgroundColor = color; }
      }
      catch (e) { /* no-op */ }
    })();
  </script>
  <title>{% block title %}{% endblock %}{{ instance_name }}</title>
  {% block meta %}{% endblock %}
  {% if rtl %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/searxng-rtl.min.css') }}" type="text/css" media="screen">
  {% else %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/searxng-ltr.min.css') }}" type="text/css" media="screen">
  {% endif %}
  {% if get_setting('server.limiter') or get_setting('server.public_instance') %}
  <link rel="stylesheet" href="{{ url_for('client_token', token=link_token) }}" type="text/css">
  {% endif %}
  <script>
    // update the css
    document.documentElement.classList.remove('no-js');
    document.documentElement.classList.add('js');
  </script>
  <script>
    (function applyEstAutoTheme()
    {
      try
      {
        var root = document.documentElement;
        if (!/(^|\s)theme-auto(\s|$)/.test(root.className)) { return; }
        var getESTHour = function()
        {
          try
          {
            return parseInt(new Intl.DateTimeFormat('en-US', { hour: 'numeric', hour12: false, timeZone: 'America/New_York' }).format(new Date()), 10);
          }
          catch (e)
          {
            return (new Date()).getUTCHours();
          }
        };
        var apply = function()
        {
          var hour = getESTHour();
          var estLight = hour >= 7 && hour < 19;
          root.classList.remove('est-light', 'est-dark');
          root.classList.add(estLight ? 'est-light' : 'est-dark');
          var color = estLight ? '#eafaf7' : '#1e2030';
          var meta = document.querySelector('meta[name="theme-color"]');
          if (meta) { meta.setAttribute('content', color); }
        };
        apply();
        setInterval(apply, 300000); // refresh every 5 minutes
      }
      catch (e) { /* no-op */ }
    })();
  </script>
  {% block head %}
  <link title="{{ instance_name }}" type="application/opensearchdescription+xml" rel="search" href="{{ opensearch_url }}">
  {% endblock %}
  <link rel="icon" href="{{ url_for('static', filename='img/favicon.png') }}" sizes="any">
  <link rel="apple-touch-icon" href="{{ url_for('static', filename='img/favicon.png') }}">
  <style>
    :root {
      --musai-primary: #6e62a6; /* deeper purple-steel */
      --musai-accent: #9aa3c7;  /* cooler steel accent */
      --musai-bg: #1e2030;      /* slightly cooler base */
      --musai-bg-2: #2a2e42;    /* purple-steel surface */
      --musai-text: #ececf4;
      --musai-muted: #aab0c8;
    }
    /* Light mode palette and surfaces */
    html.theme-light {
      --musai-primary: #0f766e; /* teal-700 */
      --musai-accent: #14b8a6;  /* teal-500 */
      --musai-bg: #eafaf7;      /* very light teal */
      --musai-bg-2: #dff5f0;    /* very light teal (accent) */
      --musai-text: #222222;    /* dark text for contrast */
      --musai-muted: #506a6a;   /* muted teal-gray */
    }
    @media (prefers-color-scheme: light) {
      html.theme-auto {
        --musai-primary: #0f766e;
        --musai-accent: #14b8a6;
        --musai-bg: #eafaf7;
        --musai-bg-2: #dff5f0;
        --musai-text: #222222;
        --musai-muted: #506a6a;
      }
    }
    body {
      background: var(--musai-bg);
      color: var(--musai-text);
    }
    /* Keep content clear of the docked AI bar */
    main {
      padding-bottom: calc(120px + env(safe-area-inset-bottom));
    }
    /* When AI chat is collapsed, reduce the cognitive footprint at the bottom */
    html.ai-chat-collapsed main {
      padding-bottom: calc(56px + env(safe-area-inset-bottom));
    }
    a { color: var(--musai-muted); }
    a:hover { color: var(--musai-accent); }
    /* Do not recolor custom logo assets */
    #search_logo svg circle,
    #search_logo svg path,
    #search_logo svg rect { stroke: inherit; fill: inherit; }
    #search_logo img, #search_logo picture { display: block; height: 80px; width: auto; }
    /* Create healthy spacing between the logo and the search input */
    #search_header
    {
      display: flex;
      align-items: center;
      column-gap: 16px;
    }
    /* Search page only: gently nudge the logo for better visual alignment */
    #main_search #search_logo
    {
      position: relative;
      left: -10px; /* shift left by 10px */
      top: -2px;  /* shift up by ~2px */
    }
    /* Results page only: add extra breathing room below the logo/header */
    #main_results #search_header
    {
      padding-bottom: 16px;
    }
    .search_box {
      background: rgba(46,50,66,.6);
      border: 1px solid var(--musai-primary);
      box-shadow: 0 4px 24px rgba(0,0,0,.35);
      border-radius: 14px;
    }
    @media (prefers-color-scheme: light) { html.theme-auto .search_box { background: rgba(255,255,255,.9); } }
    html.theme-light .search_box { background: rgba(255,255,255,.9); }
    /* Use theme-aware input text color to ensure readability on light/dark */
    #q { color: var(--color-search-font); }
    #q::placeholder { color: #aab0c8; opacity: .9; }
    /* Prevent iOS Safari auto-zoom on focus */
    @media (max-width: 640px) {
      #q { font-size: 16px; }
    }
    #send_search {
      background: var(--musai-primary);
      color: #fff;
      border-radius: 12px;
      border: 0;
    }
    #send_search:hover { filter: brightness(1.1); }
    footer { color: var(--musai-muted); }
    /* Add breathing room below the categories (General, Images, Videos, etc.) */
    #categories {
      padding-bottom: 12px;
    }
    /* Dark-mode tuning: harmonize default SearXNG variables to Musai palette */
    html.theme-dark,
    html.theme-black,
    html.theme-auto.est-dark
    {
      /* Accents and interactive elements */
      --color-url-font: #aab0c8; /* general links */
      --color-result-link-font: #a78bfa; /* result titles */
      --color-result-link-font-highlight: #c4b5fd;
      --color-result-link-visited-font: #c4b5fd;
      --color-categories-item-selected-font: #a78bfa;
      --color-categories-item-border-selected: #a78bfa;
      --color-btn-background: #6e62a6; /* Musai primary for buttons */
      --color-btn-font: #ffffff;
      --color-search-background: #2a2e42; /* search field surface */
      --color-search-font: #ececf4; /* search field text */

      /* Surfaces */
      --color-header-background: #1e2030;
      --color-sidebar-background: #2a2e42;
      --color-result-background: #2a2e42;
      --color-result-border: #3b3f57;
      --color-result-url-font: #cbd5e1;
    }
    /* Mobile: swap categories row for a compact dropdown */
    #categories_mobile { display: none; }
    @media (max-width: 640px) {
      #categories { display: none; }
      #categories_mobile { display: block; padding: 6px 0 12px; }
      #categories_mobile select {
        width: 100%;
        padding: 10px 12px;
        background: rgba(46,50,66,.6);
        border: 1px solid var(--musai-primary);
        color: var(--musai-text);
        border-radius: 10px;
      }
    }
    /* Keep categories/search types away from the top-right utility links */
    @media (min-width: 1025px) {
      #search_header,
      #categories {
        padding-right: 160px; /* space for About / Preferences */
      }
    }
    @media (min-width: 768px) and (max-width: 1024px) {
      #search_header,
      #categories {
        padding-right: 110px;
      }
    }
    /* AI chat area — docked at the bottom as a floating bar */
    #ai_chat {
      background: rgba(46,50,74,.9);
      border: 1px solid var(--musai-primary);
      box-shadow: 0 4px 24px rgba(0,0,0,.35);
      border-radius: 12px;
      padding: 8px;
      /* Docked, centered */
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: calc(16px + env(safe-area-inset-bottom));
      width: min(900px, calc(100vw - 28px));
      z-index: 999;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    /* Collapse affordance (left-most) */
    #ai_chat .ai-toggle {
      background: var(--musai-primary);
      color: #fff;
      border-radius: 10px;
      border: 0;
      height: 32px;
      width: 36px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      line-height: 1;
      cursor: pointer;
      flex: 0 0 auto;
    }
    #ai_chat .ai-toggle:hover {
      filter: brightness(1.1);
    }
    /* Brand cue appears only when collapsed */
    #ai_chat .ai-brand {
      display: none;
      font-weight: 600;
      color: var(--musai-text);
      opacity: .9;
      margin-left: 4px;
    }
    /* Collapsed visual state: hide input/output, show compact identity */
    #ai_chat.collapsed {
      padding: 6px 10px;
      gap: 8px;
    }
    #ai_chat.collapsed form,
    #ai_chat.collapsed #ai_chat_output {
      display: none;
    }
    #ai_chat.collapsed .ai-brand {
      display: inline;
    }
    @media (min-width: 1025px) {
      #ai_chat input[type="text"] {
        height: 44px;
      }
      /* scope sizing to the send button only, not POV toggles */
      #ai_chat #ai_chat_send {
        height: 44px;
        width: 48px;
      }
    }
    @media (max-width: 1024px) {
      #ai_chat { bottom: 8px; width: calc(100% - 16px); }
    }
    @media (prefers-color-scheme: light) { html.theme-auto #ai_chat { background: rgba(255,255,255,.9); } }
    html.theme-light #ai_chat { background: rgba(255,255,255,.9); }
    #ai_chat form { flex: 1; display: flex; align-items: center; gap: 8px; margin: 0; }
    #ai_chat input[type="text"] {
      flex: 1;
      min-width: 0;
      height: 40px;
      padding: 0 10px;
      border-radius: 10px;
      border: 1px solid var(--musai-primary);
      background: rgba(0,0,0,0.15);
      color: var(--musai-text);
    }
    /* Style the send button only so POV toggles can have their own colors */
    #ai_chat #ai_chat_send {
      background: var(--musai-primary);
      color: #fff;
      border-radius: 10px;
      border: 0;
      height: 40px;
      width: 44px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      line-height: 1;
      cursor: pointer;
    }
    #ai_chat #ai_chat_send:hover {
      filter: brightness(1.1);
    }
    /* Back to top button pinned to bottom-right */
    #backToTop {
      position: fixed;
      right: 16px;
      bottom: calc(16px + env(safe-area-inset-bottom));
      z-index: 1100; /* above AI bar */
      margin: 0;
    }
    #backToTop a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 28px;
      height: 28px;
      border-radius: 999px;
      background: var(--musai-primary);
      color: #ffffff;
      box-shadow: 0 3px 12px rgba(0,0,0,.28);
      border: 0;
      font-size: 0;
    }
    #backToTop a svg { width: 16px; height: 16px; }
    #backToTop a:hover { filter: brightness(1.1); }
    /* Align back-to-top with reduced bottom padding when collapsed */
    html.ai-chat-collapsed #backToTop {
      bottom: calc(56px + env(safe-area-inset-bottom));
    }
    #ai_chat input[type="text"][disabled],
    #ai_chat button[disabled] {
      opacity: .6;
      cursor: not-allowed;
      filter: none;
    }
    /* Output bubble appears above the docked bar */
    #ai_chat_output {
      position: absolute;
      right: 10px;
      bottom: calc(100% + 10px);
      margin-top: 0;
      padding: 10px;
      border-radius: 10px;
      background: rgba(40,34,68,0.92);
      border: 1px solid rgba(255,255,255,0.08);
      box-shadow: 0 6px 28px rgba(0,0,0,.35);
      max-width: min(420px, 60vw);
      max-height: 70vh;
      overflow: auto;
      -webkit-overflow-scrolling: touch;
      white-space: pre-wrap;
    }
    /* Typing indicator bubble (Musai-style) */
    .ai-typing-bubble {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 12px;
      background: rgba(107,91,149,.10);
      border: 1px solid rgba(107,91,149,.45);
      box-shadow: 0 2px 16px rgba(0,0,0,.25);
      position: relative;
      overflow: hidden;
    }
    .ai-typing-bubble .ai-typing-icon {
      font-size: 16px;
      line-height: 1;
    }
    .ai-typing-bubble .ai-typing-label {
      font-size: 0.95rem;
      color: var(--musai-text);
      opacity: .9;
    }
    .ai-typing-bubble .ai-typing-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #a78bfa; /* purple-400 */
    }
    html.theme-light .ai-typing-bubble {
      background: rgba(20,184,166,.10);
      border-color: rgba(20,184,166,.45);
    }
    /* Glow and dots animation */
    @keyframes mysticalGlow {
      0%, 100% { box-shadow: 0 0 14px rgba(167,139,250,.25); }
      50% { box-shadow: 0 0 22px rgba(167,139,250,.45); }
    }
    @keyframes mysticalDots {
      0%, 80%, 100% { transform: scale(0.8); opacity: 0.6; }
      40% { transform: scale(1.15); opacity: 1; }
    }
    .mystical-glow {
      animation: mysticalGlow 2s ease-in-out infinite;
    }
    .mystical-dots {
      animation: mysticalDots 1.4s ease-in-out infinite;
      display: inline-block;
    }
    /* Main response bubble (purplish) */
    .ai-main-bubble {
      background: #6e62a6; /* steel purple (opaque) */
      border: 1px solid #4f3f85; /* deeper steel border for contrast */
      color: #ffffff; /* ensure high-contrast text */
      border-radius: 10px;
      padding: 10px;
      margin-bottom: 8px;
      white-space: pre-wrap;
    }
    /* POV toggles and panels (red = logical, blue = creative) */
    .ai-pov-toggle-group {
      display: flex;
      align-items: center;
      gap: 8px;
      margin: 8px 0 6px 0;
      flex-wrap: wrap;
    }
    .ai-pov-toggle {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      font-size: 12px;
      border-radius: 999px;
      border: 1px solid transparent;
      cursor: pointer;
      user-select: none;
      background: rgba(255,255,255,0.06);
      color: var(--musai-text);
    }
    .ai-pov-toggle[disabled] {
      opacity: .5;
      cursor: not-allowed;
    }
    .ai-pov-toggle.red {
      border-color: #b91c1c;
      background: #dc2626;
      color: #ffffff;
    }
    .ai-pov-toggle.red.active {
      background: #b91c1c;
      box-shadow: inset 0 0 0 1px #7f1d1d;
    }
    .ai-pov-toggle.blue {
      border-color: #1d4ed8;
      background: #2563eb;
      color: #ffffff;
    }
    .ai-pov-toggle.blue.active {
      background: #1d4ed8;
      box-shadow: inset 0 0 0 1px #1e3a8a;
    }
    .ai-pov-panel {
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.08);
      padding: 10px;
      margin-top: 6px;
      white-space: pre-wrap;
      font-size: 0.95rem;
    }
    .ai-pov-panel.red {
      background: #dc2626;
      border-color: #b91c1c;
      color: #ffffff;
    }
    .ai-pov-panel.blue {
      background: #2563eb;
      border-color: #1d4ed8;
      color: #ffffff;
    }
    /* Mobile refinements for iPhone widths */
    @media (max-width: 640px) {
      /* So header elements don’t overflow */
      #search_header { flex-wrap: wrap; row-gap: 8px; }
      #search_logo img, #search_logo picture { height: 56px; }

      /* Larger touch targets and readable text to avoid auto-zoom */
      #ai_chat input[type="text"] { height: 44px; font-size: 16px; }
      #ai_chat #ai_chat_send { height: 44px; width: 48px; font-size: 18px; }

      /* Ensure output bubble fits and breathes on small screens */
      #ai_chat_output { max-width: min(92vw, 560px); right: 8px; }

      /* Keep the back-to-top button clear of the AI bar */
      #backToTop { bottom: calc(88px + env(safe-area-inset-bottom)); }
      /* If collapsed on small screens, further reduce the offset */
      html.ai-chat-collapsed #backToTop { bottom: calc(56px + env(safe-area-inset-bottom)); }
    }
  </style>
  <style>
    /* EST-based overrides for auto theme */
    html.theme-auto.est-light {
      --musai-primary: #0f766e;
      --musai-accent: #14b8a6;
      --musai-bg: #eafaf7;
      --musai-bg-2: #dff5f0;
      --musai-text: #222222;
      --musai-muted: #506a6a;
    }
    html.theme-auto.est-dark {
      --musai-primary: #6e62a6;
      --musai-accent: #9aa3c7;
      --musai-bg: #1e2030;
      --musai-bg-2: #2a2e42;
      --musai-text: #ececf4;
      --musai-muted: #aab0c8;
    }
    html.theme-auto.est-light .search_box { background: rgba(255,255,255,.9); }
    html.theme-auto.est-dark .search_box { background: rgba(46,50,66,.6); }
    html.theme-auto.est-light #ai_chat { background: rgba(255,255,255,.9); }
    html.theme-auto.est-dark #ai_chat { background: rgba(46,50,74,.9); }
  </style>
</head>
<body class="{{ endpoint }}_endpoint" >
  <main id="main_{{  self._TemplateReference__context.name|replace("simple/", "")|replace(".html", "") }}" class="{{body_class}}">
    {% if errors %}
        <div class="dialog-error" role="alert">
            <a href="#" class="close" aria-label="close" title="close">×</a>
            <ul>
            {% for message in errors %}
                <li>{{ message }}</li>
            {% endfor %}
            </ul>
        </div>
    {% endif %}

    <nav id="links_on_top">
      {%- from 'simple/icons.html' import icon_big -%}
      {%- block linkto_about -%}
        <a href="{{ url_for('info', pagename='about') }}" class="link_on_top_about">{{ icon_big('information-circle') }}<span>{{ _('About') }}</span></a>
      {%- endblock -%}
      {%- block linkto_donate -%}
        {%- if donation_url -%}
        <a href="{{ donation_url }}" class="link_on_top_donate">{{ icon_big('heart') }}<span>{{ _('Donate') }}</span></a>
        {%- endif -%}
      {%- endblock -%}
      {%- block linkto_preferences -%}
        <a href="{{ url_for('preferences') }}" class="link_on_top_preferences">{{ icon_big('settings') }}<span>{{ _('Preferences') }}</span></a>
      {%- endblock -%}
      {%- block linkto_musai -%}
        <a href="https://musai.codemusic.ca" class="link_on_top_musai">{{ icon_big('musical-notes') }}<span>{{ _('Musai') }}</span></a>
      {%- endblock -%}
    </nav>
    {% block header %}
    {% endblock %}
    {% block content %}
    {% endblock %}
  </main>
  <footer>
    <p>
    <strong>MusaiSearch</strong> — {{ _('powered by') }} SearXNG ({{ searx_version }}) — {{ _('a privacy-respecting, open metasearch engine') }}<br>
        <a href="{{ url_for('info', pagename='about') }}">{{ _('About MusaiSearch') }}</a>
        <a href="{{ searx_git_url }}">{{ _('Source code') }}</a>
        | <a href="{{ get_setting('brand.issue_url') }}">{{ _('Issue tracker') }}</a>
        {% if enable_metrics %}| <a href="{{ url_for('stats') }}">{{ _('Engine stats') }}</a>{% endif %}
        {% if get_setting('brand.public_instances') %}
        | <a href="{{ get_setting('brand.public_instances') }}">{{ _('Public instances') }}</a>
        {% endif %}
        {% if get_setting('general.privacypolicy_url') %}
        | <a href="{{ get_setting('general.privacypolicy_url') }}">{{ _('Privacy policy') }}</a>
        {% endif %}
        {% if get_setting('general.contact_url') %}
        | <a href="{{ get_setting('general.contact_url') }}">{{ _('Contact instance maintainer') }}</a>
        {% endif %}
        {% for title, link in get_setting('brand.custom.links').items() %}
        | <a href="{{ link }}">{{ _(title) }}</a>
        {% endfor %}
        | <a href="https://musai.codemusic.ca">{{ _('Back to Musai') }}</a>
    </p>
  </footer>
  <script type="module" src="{{ url_for('static', filename='js/searxng.core.min.js') }}" client_settings="{{ client_settings }}"></script>
</body>
</html>
